openapi: 3.0.0
info:
  title: DOC2PDF Converter API
  description: |
    API REST profissional para convers√£o de documentos Word (.DOCX) para PDF com substitui√ß√£o inteligente de tags.

    ## Funcionalidades
    - üìÑ Convers√£o DOCX ‚Üí PDF
    - üè∑Ô∏è Substitui√ß√£o de tags no formato `{TAG}`
    - üé® 3 perfis de qualidade (high/medium/low)
    - üìä Suporte para tags em par√°grafos, tabelas, cabe√ßalhos e rodap√©s
    - üöÄ Retorno em Base64 ou arquivo direto

    ## Autor
    **Maxwell da Silva Oliveira**
    üìß maxwbh@gmail.com
    üè¢ M&S do Brasil LTDA
    üîó [LinkedIn](https://linkedin.com/in/maxwbh)

  version: 1.5.0
  contact:
    name: Maxwell da Silva Oliveira
    email: maxwbh@gmail.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: http://localhost:5000
    description: Desenvolvimento local
  - url: https://doc2pdf.onrender.com
    description: Produ√ß√£o (Render)

tags:
  - name: Health
    description: Endpoints de sa√∫de e informa√ß√µes da API
  - name: Convert
    description: Convers√£o de documentos DOCX para PDF

paths:
  /health:
    get:
      tags:
        - Health
      summary: Health Check
      description: Verifica se a API est√° online e funcionando
      responses:
        '200':
          description: API est√° funcionando
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: healthy
                  service:
                    type: string
                    example: DOC2PDF Converter API
                  version:
                    type: string
                    example: 1.5.0

  /:
    get:
      tags:
        - Health
      summary: Informa√ß√µes da API
      description: Retorna informa√ß√µes detalhadas sobre a API, endpoints dispon√≠veis e documenta√ß√£o
      responses:
        '200':
          description: Informa√ß√µes da API
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: string
                  version:
                    type: string
                  endpoints:
                    type: object
                  documentation:
                    type: object

  /convert:
    post:
      tags:
        - Convert
      summary: Converte DOCX para PDF (retorna Base64)
      description: |
        Converte documento Word para PDF com substitui√ß√£o de tags e retorna o PDF em Base64.

        ### Tags
        - Formato: `{TAG}` (case-insensitive)
        - Suportadas em: par√°grafos, tabelas, cabe√ßalhos e rodap√©s
        - Podem ser repetidas ilimitadamente

        ### Qualidade
        - **high** (padr√£o): 300 DPI, ideal para impress√£o
        - **medium**: 150 DPI, balanceado para email
        - **low**: 75 DPI, otimizado para web

      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - document
                - replacements
              properties:
                document:
                  type: string
                  format: byte
                  description: Documento DOCX codificado em Base64
                  example: JVBERi0xLjQKJeLjz9MKMSAwIG9iago8PC9UeXBlL...
                replacements:
                  type: object
                  description: Objeto com tags e valores para substitui√ß√£o
                  additionalProperties:
                    type: string
                  example:
                    NOME: Jo√£o Silva
                    CPF: "123.456.789-00"
                    DATA: "05/12/2025"
                quality:
                  type: string
                  enum: [high, medium, low]
                  default: high
                  description: Perfil de qualidade do PDF
            examples:
              contrato:
                summary: Exemplo de contrato
                value:
                  document: JVBERi0xLjQK...
                  replacements:
                    CONTRATANTE: Empresa ABC LTDA
                    CONTRATADO: Jo√£o Silva
                    VALOR: R$ 10.000,00
                    DATA: "05/12/2025"
                  quality: high
              certificado:
                summary: Exemplo de certificado
                value:
                  document: JVBERi0xLjQK...
                  replacements:
                    NOME_ALUNO: Maria Santos
                    CURSO: Python Avan√ßado
                    DATA_CONCLUSAO: "05/12/2025"
                  quality: medium

      responses:
        '200':
          description: PDF gerado com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  pdf:
                    type: string
                    format: byte
                    description: PDF codificado em Base64
                  message:
                    type: string
                    example: Documento convertido com sucesso
                  processing_time:
                    type: number
                    format: float
                    example: 5.234
                  stats:
                    type: object
                    properties:
                      input_size:
                        type: integer
                      output_size:
                        type: integer
                      quality:
                        type: string
                      replacements_count:
                        type: integer

        '400':
          description: Erro de valida√ß√£o
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

        '500':
          description: Erro interno do servidor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /convert-file:
    post:
      tags:
        - Convert
      summary: Converte DOCX para PDF (retorna arquivo)
      description: |
        Converte documento Word para PDF com substitui√ß√£o de tags e retorna o arquivo PDF para download.

        √ötil quando voc√™ quer baixar o PDF diretamente sem precisar decodificar Base64.

      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - document
                - replacements
              properties:
                document:
                  type: string
                  format: byte
                  description: Documento DOCX codificado em Base64
                replacements:
                  type: object
                  description: Objeto com tags e valores
                  additionalProperties:
                    type: string
                filename:
                  type: string
                  default: documento.pdf
                  description: Nome do arquivo PDF de sa√≠da
                  example: contrato.pdf
                quality:
                  type: string
                  enum: [high, medium, low]
                  default: high

      responses:
        '200':
          description: Arquivo PDF para download
          content:
            application/pdf:
              schema:
                type: string
                format: binary
          headers:
            Content-Disposition:
              schema:
                type: string
              description: attachment; filename="documento.pdf"

        '400':
          description: Erro de valida√ß√£o
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /process:
    post:
      tags:
        - Convert
      summary: Endpoint flex√≠vel (m√∫ltiplas op√ß√µes)
      description: |
        Endpoint flex√≠vel que permite diferentes combina√ß√µes de entrada e sa√≠da.

        ### Tipos de Entrada (input_type)
        - **base64**: Documento DOCX em Base64 (padr√£o)
        - **doc**: Documento DOCX como bytes

        ### Tipos de Sa√≠da (output_type)
        - **pdf**: Arquivo PDF para download
        - **doc**: Arquivo DOCX modificado para download
        - **base64_pdf**: PDF em Base64 (JSON)
        - **base64_doc**: DOCX em Base64 (JSON)

      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - document
                - replacements
              properties:
                document:
                  type: string
                  description: Documento (formato depende de input_type)
                replacements:
                  type: object
                  additionalProperties:
                    type: string
                input_type:
                  type: string
                  enum: [base64, doc]
                  default: base64
                output_type:
                  type: string
                  enum: [pdf, doc, base64_pdf, base64_doc]
                  default: pdf
                filename:
                  type: string
                  default: documento
                quality:
                  type: string
                  enum: [high, medium, low]
                  default: high

      responses:
        '200':
          description: Resposta varia conforme output_type
          content:
            application/pdf:
              schema:
                type: string
                format: binary
            application/vnd.openxmlformats-officedocument.wordprocessingml.document:
              schema:
                type: string
                format: binary
            application/json:
              schema:
                oneOf:
                  - type: object
                    properties:
                      success:
                        type: boolean
                      pdf:
                        type: string
                        format: byte
                  - type: object
                    properties:
                      success:
                        type: boolean
                      document:
                        type: string
                        format: byte

components:
  schemas:
    Error:
      type: object
      properties:
        error:
          type: string
          description: Mensagem de erro
          example: Campo "document" √© obrigat√≥rio

    QualityProfile:
      type: string
      enum: [high, medium, low]
      description: |
        Perfil de qualidade do PDF:
        - **high**: 300 DPI, qualidade JPEG 95%, ideal para impress√£o (2-5 MB)
        - **medium**: 150 DPI, qualidade JPEG 85%, balanceado (500 KB - 2 MB)
        - **low**: 75 DPI, qualidade JPEG 70%, otimizado para web (100-500 KB)

  securitySchemes: {}

externalDocs:
  description: Documenta√ß√£o completa no GitHub
  url: https://github.com/Maxwbh/doc2pdf
